# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—é

## –ú–æ—Ç–∏–≤–∞—Ü–∏—è

–ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–≥–∞–º. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã–Ω—É–∂–¥–µ–Ω—ã –≤—Ä—É—á–Ω—É—é –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ü–µ–ø–æ—á–∫—É —Å–æ–±—ã—Ç–∏–π –ø–æ –∂–∞–ª–æ–±–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫:

- –ü–æ—Ç–µ—Ä–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∞–Ω–∞–ª–∏–∑ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤.
- –í—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –Ω–∞ –∫–æ–º–∞–Ω–¥—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏.
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–±–æ–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –æ—à–∏–±–æ–∫.

–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- –ü–æ–∑–≤–æ–ª–∏—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–º–µ–Ω—É —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞).
- –ü–æ–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–µ–µ —É—Å—Ç—Ä–∞–Ω—è—Ç—å –±–∞–≥–∏.
- –£–ª—É—á—à–∏—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –∏ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.
- –î–∞—Å—Ç –±–∞–∑—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞.

## –ö–∞–∫–∏–µ –ª–æ–≥–∏ —Å–æ–±–∏—Ä–∞—Ç—å –∏ –æ—Ç–∫—É–¥–∞

**–°–∏—Å—Ç–µ–º—ã:**
- –û–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω (Java Spring Boot)
- CRM (Java Spring Boot)
- MES (C#)
- RabbitMQ (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ë–î (—á–µ—Ä–µ–∑ —ç–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤)

**–õ–æ–≥–∏ —É—Ä–æ–≤–Ω—è INFO:**
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞: order_id, user_id, –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å, timestamp.
- –ü–æ–ª—É—á–µ–Ω–∏–µ / –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ RabbitMQ: message_id, source, destination.
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ –ø–∞—Ä–æ–ª–µ–π): user_id, role.
- –ù–∞—á–∞–ª–æ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏: –≤—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è, order_id.
- –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–∞ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è.

**–£—Ä–æ–≤–µ–Ω—å DEBUG:**
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–ª–æ–∂–Ω—ã—Ö –∫–µ–π—Å–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥–∏).

**–£—Ä–æ–≤–µ–Ω—å ERROR:**
- –ò—Å–∫–ª—é—á–µ–Ω–∏—è, —Ñ–∞—Ç–∞–ª—å–Ω—ã–µ —Å–±–æ–∏, —Ç–∞–π–º-–∞—É—Ç—ã, —Å–±–æ–∏ –≤ –æ—á–µ—Ä–µ–¥—è—Ö –∏ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö.

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

1. MES ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –∑–æ–Ω–∞ –ø—Ä–æ–±–ª–µ–º –∏ –∂–∞–ª–æ–±.
2. RabbitMQ ‚Äî –ø—Ä–æ–ø–∞–¥–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è.
3. –û–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω –∏ CRM ‚Äî –¥–∞–ª–µ–µ –ø–æ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏.

## –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

- –í–Ω–µ–¥—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤ –Ω–∞ –±–∞–∑–µ **Loki + Grafana + Promtail**:
  - –ü—Ä–æ—Å—Ç–æ–π –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å—Ç–µ–∫, —Ö–æ—Ä–æ—à–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å Prometheus.
- –î–ª—è Java ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Logback` —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤ stdout + Promtail.
- –î–ª—è C# ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Serilog` + sink –¥–ª—è stdout + Promtail.
- –•—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –≤ Loki —Å —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ —Å–∏—Å—Ç–µ–º–µ, —É—Ä–æ–≤–Ω—é –∏ order_id.
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –ø–æ ERROR –∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º —à–∞–±–ª–æ–Ω–∞–º –ª–æ–≥–æ–≤.

**–î–∏–∞–≥—Ä–∞–º–º–∞ C4 (–æ–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è)**
![jewerly_c4_model-logging.png](jewerly_c4_model-logging.png)
üîó [–°—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∞–Ω–Ω—É—é —Å—Ö–µ–º—É —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º (Loki)](./jewerly_c4_model-logging.drawio)

## –ü–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ –ª–æ–≥–æ–≤ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ç–µ–ª–µ—Ñ–æ–Ω, email, –∏–º—è).
- –î–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ VPN, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ä–æ–ª–∏: DevOps, –ø–æ–¥–¥–µ—Ä–∂–∫–∞.
- –•—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ ‚Äî –¥–æ 30 –¥–Ω–µ–π, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–≥—Ä—É–∑–∫–∏ –∞—Ä—Ö–∏–≤–æ–≤.

## –ü–æ–ª–∏—Ç–∏–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

| –°–∏—Å—Ç–µ–º–∞  | –ò–Ω–¥–µ–∫—Å    | –°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è |
|----------|-----------|---------------|
| MES      | mes-logs  | 30 –¥–Ω–µ–π       |
| Shop     | shop-logs | 14 –¥–Ω–µ–π       |
| CRM      | crm-logs  | 14 –¥–Ω–µ–π       |
| RabbitMQ | mq-logs   | 7 –¥–Ω–µ–π        |

## –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞:
  - ‚Äúorder_id=XXX error‚Äù
  - ‚Äútimeout‚Äù + ‚Äúservice_name‚Äù
  - ‚Äústatus change failed‚Äù
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ª–æ–≥–æ–≤ —É—Ä–æ–≤–Ω—è ERROR > 10 –∑–∞ 5 –º–∏–Ω—É—Ç.
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –ø–æ–∏—Å–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–∑–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤).

## –î–æ–ø –∑–∞–¥–∞–Ω–∏–µ: –∫—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–±–æ—Ä–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö—Ä–∏—Ç–µ—Ä–∏–π                | ELK                 | OpenSearch | Loki       | Splunk        |
|-------------------------|---------------------|------------|------------|---------------|
| –õ–∏—Ü–µ–Ω–∑–∏—è                | Elastic             | Apache 2.0 | Apache 2.0 | –ü—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω–∞—è |
| –ü—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏      | –°—Ä–µ–¥–Ω—è—è             | –°—Ä–µ–¥–Ω—è—è    | –í—ã—Å–æ–∫–∞—è    | –ù–∏–∑–∫–∞—è        |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus | –ü–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ       | –•–æ—Ä–æ—à–æ     | –û—Ç–ª–∏—á–Ω–æ    | –°—Ä–µ–¥–Ω–µ        |
| –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º   | –í—ã—Å–æ–∫–∏–µ             | –í—ã—Å–æ–∫–∏–µ    | –ù–∏–∑–∫–∏–µ     | –í—ã—Å–æ–∫–∏–µ       |
| –°—Ç–æ–∏–º–æ—Å—Ç—å               | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (—É—Å–ª–æ–≤–Ω–æ) | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ  | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ  | –î–æ—Ä–æ–≥–æ        |

**–í—ã–≤–æ–¥:** Loki ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –∫–æ–º–∞–Ω–¥—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Å—Ç–µ–∫–æ–º Prometheus + Grafana.

